<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RFID Data Table</title>

    <style>
        body {
            font-family: 'Poppins', sans-serif;
           
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            transition: background-color 0.5s;
            background-image: url('backgroundweb.jpg'); /* Gambar background */
            background-size: cover;
            background-position: center;
            color: #fff;
            text-align: center;
            position: relative;
        }
        body::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(171, 168, 168, 0.6); /* Overlay gelap untuk kontras */
            z-index: -1;
        }
        h1 {
            color: #fff;
            font-size: 2.5em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.5) ;
        }

        #tanggal {
            font-size: 1.5em;
            color: #f8f8f8;
            margin-right: 20px;
         
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.2);
        }

        
        #clock  {
            font-size: 1.5em;
            color: #f8f8f8;
            margin-right: 20px;
         
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.2);
        }
        table {
            width: 90%;
            max-width: 1000px;
            border-collapse: collapse;
            margin: 20px auto;
            background-color: rgba(255, 255, 255, 0.8); 
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.3);
        }
        th, td {
            padding: 16px 20px;
            text-align: center;
            border-bottom: 1px solid #ddd;
            cursor: pointer;
        }
        th {
            background-color: #4CAF50;
            color: white;
            font-size: 1.1em;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
        }
        th:hover {
            background-color: #45a049;
        }
        tr {
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 0.4s forwards;
        }
        tr:nth-child(even) {
            background-color: rgba(0, 191, 255, 0.2);
        }
        tr:hover {
            background-color: #f0a500;
            color: #fff;
            transition: 0.3s;
        }
        footer {
            margin-top: 20px;
            color: #fff;
            font-size: 0.9em;
            text-align: center;
        }
        .toggle-mode {
            position: absolute;
            top: 20px;
            right: 20px;
            background: #333;
            color: #fff;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s;
        }
        .dark-mode {
            background-color: #1a1a1a;
            color: #161515;
        }
        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        @media (max-width: 768px) {
            table, th, td {
                font-size: 0.9em;
            }
        }
    </style>
</head>
<body>
    <h1>RFID Data Table</h1>
    <div id="tanggal"></div>
    <div id="clock"></div>

    <button class="toggle-mode" onclick="toggleDarkMode()">Dark/Light</button>
    
    <table border="1" cellspacing="0" cellpadding="3"> 
        <thead>
            <tr>
                <th onclick="sortTable(0)">ID</th>
                <th onclick="sortTable(1)">RFID</th>
                <th onclick="sortTable(2)">Timestemp</th> 
            </tr>
        </thead>
        <tbody id="rfidTableBody">
            <!-- Data akan ditambahkan di sini oleh JavaScript -->
        </tbody>
    </table>

    <footer>
        <p>&copy; 2024 RFID Data Management System</p>
    </footer>

    <script>

function updateTanggal() {
    const tanggalElement = document.getElementById('tanggal');
    const now = new Date();
    const tanggalFormatted = now.getDate() + '-' + (now.getMonth() + 1) + '-' + now.getFullYear();
    tanggalElement.textContent = tanggalFormatted;
}
updateTanggal();

        setInterval(updateTanggal, 1000);
        updateTanggal();

        //fungsi untuk memperbaharui jam setiap detik
        function updateClock() {
            const clockElement = document.getElementById('clock');
            //const date = document.getElementById('date');
            const now = new Date();

        //format jam
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            clockElement.textContent = `${hours}:${minutes}:${seconds}`;


            
        
        //format tanggal
            //const day = String(now.getDate()).padStart(2, '0');
            //const month = String(now.getMonth() + 1).padStart(2, '0');
            //const year = now.getFullYear();
            //dateElement.textContent = ${day}/${month}/${year};

        }
        setInterval(updateClock, 1000); //untuk memperbaruai setiap detik
        updateClock(); //menjalankan fungsi saat halaman dibuka

        //function updateDate() {
           
            //const now = new Date();
            //const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'};
            //calendarElement.textContent = now.toLocaleDateString('id-ID', options);

            
        //}
        //setInterval(updateDate, 1000);
        //updateDate();

        // Contoh data yang akan ditampilkan dalam tabel
        //const rfidData = [
            //{ id: 1, rfid: '123456789', timestep: '2024-09-02 12:34:56' },
            //{ id: 2, rfid: '987654321', timestep: '2024-09-02 12:35:45' },
            //{ id: 3, rfid: '112233445', timestep: '2024-09-02 12:36:22' },
            //{ id: 4, rfid: '223344556', timestep: '2024-09-02 12:37:18' },
            //{ id: 5, rfid: '264848656', timestep: '2024-09-03 13:45:10' },
        //];
        //fungsi fetch dari server
        async function fetchRFIDData() {
            try {
                const response = await fetch('http://localhost:3000/api/rfid_logs'); // Sesuaikan dengan URL server
                const data = await response.json();
                populateTable(data); // Menampilkan data ke tabel
            } catch (error) {
                console.error('Gagal mengambil data dari server:', error);
            }
        }

        function formatTimestamp(timestamp) {
    const date = new Date(timestamp);
    const day = String(date.getDate()).padStart(2, '0');
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const year = date.getFullYear();
    const hours = String(date.getHours()).padStart(2, '0');
    const minutes = String(date.getMinutes()).padStart(2, '0');
    const seconds = String(date.getSeconds()).padStart(2, '0');
    return `${day}-${month}-${year} ${hours}:${minutes}:${seconds}`;
}


        // Fungsi untuk menambahkan data ke dalam tabel
        function populateTable(data) {
    const tableBody = document.getElementById('rfidTableBody');
    tableBody.innerHTML = '';  // Bersihkan isi tabel sebelum menambah data baru
    if (data.length === 0) {
        tableBody.innerHTML = '<tr><td colspan="3">No data available</td></tr>';
        return;
    }
    data.forEach((item, index) => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${item.id}</td>
            <td>${item.Tag}</td>
            <td>${formatTimestamp(item.timestamp)}</td>
        `;
        tableBody.appendChild(row);
    });
}


        // Sorting function
        function sortTable(n) {
            const table = document.querySelector("table");
            let rows, switching, i, x, y, shouldSwitch, dir, switchcount = 0;
            switching = true;
            dir = "asc";
            while (switching) {
                switching = false;
                rows = table.rows;
                for (i = 1; i < (rows.length - 1); i++) {
                    shouldSwitch = false;
                    x = rows[i].getElementsByTagName("TD")[n];
                    y = rows[i + 1].getElementsByTagName("TD")[n];
                    if (dir === "asc") {
                        if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                            shouldSwitch = true;
                            break;
                        }
                    } else if (dir === "desc") {
                        if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
                            shouldSwitch = true;
                            break;
                        }
                    }
                }
                if (shouldSwitch) {
                    rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                    switching = true;
                    switchcount++;
                } else {
                    if (switchcount === 0 && dir === "asc") {
                        dir = "desc";
                        switching = true;
                    }
                }
            }
        }

        // Dark/Light Mode Toggle
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
        }

        // Panggil fungsi untuk menambahkan data ke dalam tabel saat halaman di muat
       // populateTable(rfidData);

        //fungsi untuk memanggil fetch data saat halaman dimuat
        document.addEventListener('DOMContentLoaded', fetchRFIDData);
    </script>

</body>
</html>
